{"ast":null,"code":"import _defineProperty from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import{showLoading}from\"../helper/loading\";import AOS from\"aos\";import\"aos/dist/aos.css\";import{paginate}from\"../helper/paginate\";import Pagination from\"../common/pagination\";import M from\"materialize-css\";import{isAuthenticated}from\"../helper/auth\";import SelectInput from\"./sections/selectInput\";import RecipeCard from\"../common/recipeCard\";import SearchInput from\"../common/searchInput\";var imageProf=require(\"../../public/uploads/chef2.jpg\");var Recipes=/*#__PURE__*/function(_Component){_inherits(Recipes,_Component);var _super=_createSuper(Recipes);function Recipes(){var _this;_classCallCheck(this,Recipes);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={recipes:[],loading:false,categories:[],currentPage:1,pageSize:6,searchQuery:\"\",selectedCategory:\"\"};_this.handleChange=function(event){var _this$setState;_this.setState((_this$setState={},_defineProperty(_this$setState,event.target.id,event.target.value),_defineProperty(_this$setState,\"selectedCategory\",\"\"),_defineProperty(_this$setState,\"currentPage\",1),_this$setState));};_this.handleSearchClose=function(){_this.setState({searchQuery:\"\"});};_this.componentDidMount=function(){AOS.init();var elems=document.querySelectorAll(\".materialboxed\");M.Materialbox.init(elems);_this.setState({loading:true});if(isAuthenticated()){var _JSON$parse=JSON.parse(localStorage.user),_id=_JSON$parse._id;_this.setState({userId:_id});}if(window.location.pathname===\"/subscriptions\"){var _JSON$parse2=JSON.parse(localStorage.user),_id2=_JSON$parse2._id;axios.post(\"/api/recipes/getSubscriptionRecipes\",{userFrom:_id2}).then(function(res){if(res.data.success){_this.setState({recipes:res.data.recipes,loading:false});}else{alert(\"fail\");}});}else{axios.get(\"/api/recipes\").then(function(_ref){var recipes=_ref.data;_this.setState({recipes:recipes,loading:false});});}axios.get(\"/api/categories\").then(function(_ref2){var categories=_ref2.data;_this.setState({categories:categories});M.AutoInit();});};_this.componentDidUpdate=function(prevProps){if(prevProps.location.pathname!==_this.props.location.pathname){_this.setState({loading:true});if(window.location.pathname===\"/subscriptions\"){var _JSON$parse3=JSON.parse(localStorage.user),_id=_JSON$parse3._id;axios.post(\"/api/recipes/getSubscriptionRecipes\",{userFrom:_id}).then(function(res){if(res.data.success){_this.setState({recipes:res.data.recipes,loading:false});}else{alert(\"fail\");}});}else{axios.get(\"/api/recipes\").then(function(_ref3){var recipes=_ref3.data;_this.setState({recipes:recipes,loading:false});});}}};_this.handlePageChange=function(page){_this.setState({currentPage:page});};_this.handleCategorySelect=function(e){console.log(e.target.value);_this.setState({selectedCategory:e.target.value,searchQuery:\"\",currentPage:1});};_this.handleSearch=function(e){e.preventDefault();_this.setState({selectedCategory:\"\",currentPage:1});};_this.handleSort=function(sortColumn){_this.setState({sortColumn:sortColumn});};_this.getPagedData=function(){var _this$state=_this.state,pageSize=_this$state.pageSize,currentPage=_this$state.currentPage,selectedCategory=_this$state.selectedCategory,searchQuery=_this$state.searchQuery,allRecipes=_this$state.recipes;var filtered=allRecipes;if(searchQuery)filtered=allRecipes.filter(function(m){return m.title.toLowerCase().startsWith(searchQuery.toLowerCase());});else if(selectedCategory&&selectedCategory!==\"\")filtered=allRecipes.filter(function(recipe){return recipe.category._id===selectedCategory;});var recipes=paginate(filtered,currentPage,pageSize);return{totalCount:filtered.length,data:recipes};};return _this;}_createClass(Recipes,[{key:\"render\",value:function render(){var _this$state2=this.state,pageSize=_this$state2.pageSize,currentPage=_this$state2.currentPage,loading=_this$state2.loading,searchQuery=_this$state2.searchQuery,categories=_this$state2.categories,selectedCategory=_this$state2.selectedCategory;var _this$getPagedData=this.getPagedData(),totalCount=_this$getPagedData.totalCount,data=_this$getPagedData.data;return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},loading?showLoading():null,/*#__PURE__*/React.createElement(\"div\",{className:\"col s12 m3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"nav-wrapper white\"},/*#__PURE__*/React.createElement(SearchInput,{onChange:this.handleChange,onSearchClose:this.handleSearchClose,searchQuery:searchQuery,onSearch:this.handleSearch}),/*#__PURE__*/React.createElement(SelectInput,{categories:categories,selectedCategory:selectedCategory,onCategorySelect:this.handleCategorySelect}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col s12 m9\"},/*#__PURE__*/React.createElement(RecipeCard,{recipes:data,imageProf:imageProf}),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(Pagination,{itemsCount:totalCount,pageSize:pageSize,currentPage:currentPage,onPageChange:this.handlePageChange})))));}}]);return Recipes;}(Component);export default Recipes;","map":{"version":3,"sources":["/Users/iashir/Desktop/WorkProjects/Recipe/client/src/components/recipes/recipes.jsx"],"names":["React","Component","axios","showLoading","AOS","paginate","Pagination","M","isAuthenticated","SelectInput","RecipeCard","SearchInput","imageProf","require","Recipes","state","recipes","loading","categories","currentPage","pageSize","searchQuery","selectedCategory","handleChange","event","setState","target","id","value","handleSearchClose","componentDidMount","init","elems","document","querySelectorAll","Materialbox","JSON","parse","localStorage","user","_id","userId","window","location","pathname","post","userFrom","then","res","data","success","alert","get","AutoInit","componentDidUpdate","prevProps","props","handlePageChange","page","handleCategorySelect","e","console","log","handleSearch","preventDefault","handleSort","sortColumn","getPagedData","allRecipes","filtered","filter","m","title","toLowerCase","startsWith","recipe","category","totalCount","length"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { showLoading } from \"../helper/loading\";\nimport AOS from \"aos\";\nimport \"aos/dist/aos.css\";\nimport { paginate } from \"../helper/paginate\";\nimport Pagination from \"../common/pagination\";\nimport M from \"materialize-css\";\nimport { isAuthenticated } from \"../helper/auth\";\nimport SelectInput from \"./sections/selectInput\";\nimport RecipeCard from \"../common/recipeCard\";\nimport SearchInput from \"../common/searchInput\";\n\nconst imageProf = require(\"../../public/uploads/chef2.jpg\");\n\nclass Recipes extends Component {\n  state = {\n    recipes: [],\n    loading: false,\n    categories: [],\n    currentPage: 1,\n    pageSize: 6,\n    searchQuery: \"\",\n    selectedCategory: \"\",\n  };\n\n  handleChange = (event) => {\n    this.setState({\n      [event.target.id]: event.target.value,\n      selectedCategory: \"\",\n      currentPage: 1,\n    });\n  };\n  handleSearchClose = () => {\n    this.setState({ searchQuery: \"\" });\n  };\n  componentDidMount = () => {\n    AOS.init();\n    var elems = document.querySelectorAll(\".materialboxed\");\n    M.Materialbox.init(elems);\n    this.setState({ loading: true });\n    if (isAuthenticated()) {\n      let { _id } = JSON.parse(localStorage.user);\n      this.setState({ userId: _id });\n    }\n    if (window.location.pathname === \"/subscriptions\") {\n      let { _id } = JSON.parse(localStorage.user);\n      axios\n        .post(\"/api/recipes/getSubscriptionRecipes\", {\n          userFrom: _id,\n        })\n        .then((res) => {\n          if (res.data.success) {\n            this.setState({ recipes: res.data.recipes, loading: false });\n          } else {\n            alert(\"fail\");\n          }\n        });\n    } else {\n      axios.get(\"/api/recipes\").then(({ data: recipes }) => {\n        this.setState({ recipes, loading: false });\n      });\n    }\n    axios.get(\"/api/categories\").then(({ data: categories }) => {\n      this.setState({ categories });\n      M.AutoInit();\n    });\n  };\n  componentDidUpdate = (prevProps) => {\n    if (prevProps.location.pathname !== this.props.location.pathname) {\n      this.setState({ loading: true });\n      if (window.location.pathname === \"/subscriptions\") {\n        let { _id } = JSON.parse(localStorage.user);\n        axios\n          .post(\"/api/recipes/getSubscriptionRecipes\", {\n            userFrom: _id,\n          })\n          .then((res) => {\n            if (res.data.success) {\n              this.setState({ recipes: res.data.recipes, loading: false });\n            } else {\n              alert(\"fail\");\n            }\n          });\n      } else {\n        axios.get(\"/api/recipes\").then(({ data: recipes }) => {\n          this.setState({ recipes, loading: false });\n        });\n      }\n    }\n  };\n  handlePageChange = (page) => {\n    this.setState({ currentPage: page });\n  };\n\n  handleCategorySelect = (e) => {\n    console.log(e.target.value);\n    this.setState({\n      selectedCategory: e.target.value,\n      searchQuery: \"\",\n      currentPage: 1,\n    });\n  };\n\n  handleSearch = (e) => {\n    e.preventDefault();\n    this.setState({\n      selectedCategory: \"\",\n      currentPage: 1,\n    });\n  };\n\n  handleSort = (sortColumn) => {\n    this.setState({ sortColumn });\n  };\n\n  getPagedData = () => {\n    const {\n      pageSize,\n      currentPage,\n      selectedCategory,\n      searchQuery,\n      recipes: allRecipes,\n    } = this.state;\n\n    let filtered = allRecipes;\n    if (searchQuery)\n      filtered = allRecipes.filter((m) =>\n        m.title.toLowerCase().startsWith(searchQuery.toLowerCase())\n      );\n    else if (selectedCategory && selectedCategory !== \"\")\n      filtered = allRecipes.filter(\n        (recipe) => recipe.category._id === selectedCategory\n      );\n\n    const recipes = paginate(filtered, currentPage, pageSize);\n\n    return { totalCount: filtered.length, data: recipes };\n  };\n\n  render() {\n    const {\n      pageSize,\n      currentPage,\n      loading,\n      searchQuery,\n      categories,\n      selectedCategory,\n    } = this.state;\n    const { totalCount, data } = this.getPagedData();\n\n    return (\n      <div className=\"container\">\n        <div className=\"row\">\n          {loading ? showLoading() : null}\n          <div className=\"col s12 m3\">\n            <div className=\"nav-wrapper white\">\n              <SearchInput\n                onChange={this.handleChange}\n                onSearchClose={this.handleSearchClose}\n                searchQuery={searchQuery}\n                onSearch={this.handleSearch}\n              />\n              <SelectInput\n                categories={categories}\n                selectedCategory={selectedCategory}\n                onCategorySelect={this.handleCategorySelect}\n              />\n            </div>\n          </div>\n          <div className=\"col s12 m9\">\n            <RecipeCard recipes={data} imageProf={imageProf} />\n            <div className=\"row\">\n              <Pagination\n                itemsCount={totalCount}\n                pageSize={pageSize}\n                currentPage={currentPage}\n                onPageChange={this.handlePageChange}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Recipes;\n"]},"metadata":{},"sourceType":"module"}