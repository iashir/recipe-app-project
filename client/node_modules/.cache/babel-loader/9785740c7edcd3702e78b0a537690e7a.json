{"ast":null,"code":"var _jsxFileName = \"/Users/iashir/Desktop/WorkProjects/Recipe/client/src/components/login.jsx\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport classnames from \"classnames\";\nimport { setAuthentication, isAuthenticated } from \"./helper/auth\";\nimport { showLoading } from \"./helper/loading\";\nimport { login, googleLogin } from \"../api/auth\";\nimport Validator from \"validator\";\nimport GoogleLogin from \"react-google-login\";\nimport { toast } from \"react-toastify\";\n\nclass Login extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      errors: {},\n      loading: false,\n      successMessage: \"\"\n    };\n\n    this.componentDidMount = () => {\n      if (isAuthenticated() && isAuthenticated().role === 1) {\n        this.props.history.push(\"/admin\");\n      } else if (isAuthenticated() && isAuthenticated().role === 0) {\n        this.props.history.push(\"/recipes\");\n      }\n\n      if (this.props.history.location.state) {\n        const {\n          username,\n          password\n        } = this.props.history.location.state;\n        this.setState({\n          username,\n          password\n        });\n      }\n    };\n\n    this.responseSuccessGoogle = response => {\n      const tokenId = {\n        tokenId: response.tokenId\n      };\n      this.setState({\n        loading: true\n      });\n      googleLogin(tokenId).then(res => {\n        const {\n          token,\n          user\n        } = res.data;\n        console.log(res.data);\n        setAuthentication(token, user);\n\n        if (isAuthenticated() && isAuthenticated().role === 1) {\n          this.props.history.push(\"/admin\");\n          window.location.reload(false);\n        } else {\n          this.props.history.push(\"/recipes\");\n          window.location.reload(false);\n        }\n\n        const {\n          username\n        } = JSON.parse(localStorage.user);\n        toast.success(`Signed in as ${username}`, {\n          position: \"bottom-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined\n        });\n        this.setState({\n          loading: false\n        });\n      }).catch(err => {\n        this.setState({\n          loading: false\n        });\n      });\n    };\n\n    this.responseErrorGoogle = response => {\n      console.log(response);\n    };\n\n    this.validate = s => {\n      if (/^(\\w+\\s?)*\\s*$/.test(s)) {\n        return s.replace(/\\s+$/, \"\");\n      }\n\n      console.log(\"TEST\");\n      let trim = s.trim();\n      return trim;\n    };\n\n    this.handleChange = e => {\n      const badInput = e.target.value;\n      var value = badInput.replace(/  +/g, \" \");\n      this.setState({\n        [e.target.id]: value\n      });\n      this.validateForm(e.target.id, value);\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      const userData = {\n        username: this.state.username.trim(),\n        password: this.state.password.trim()\n      };\n      this.setState({\n        loading: true\n      });\n      login(userData).then(res => {\n        // Set User to localStorage and Token to Cookies\n        const {\n          token,\n          user\n        } = res.data;\n        setAuthentication(token, user);\n\n        if (isAuthenticated() && isAuthenticated().role === 1) {\n          this.props.history.push(\"/admin/recipes\");\n          window.location.reload(false);\n        } else {\n          this.props.history.push(\"/recipes\");\n          window.location.reload(false);\n        }\n\n        this.setState({\n          loading: false,\n          successMessage: res.data.successMessage\n        });\n        const {\n          username\n        } = JSON.parse(localStorage.user);\n        toast.success(`Signed in as ${username}`, {\n          position: \"bottom-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined\n        });\n      }).catch(err => {\n        this.setState({\n          errors: err.response.data,\n          loading: false\n        });\n        toast.error(\"Username or Password is invalid\", {\n          position: \"bottom-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined\n        });\n      });\n    };\n  }\n\n  validateForm(fieldName, value) {\n    const {\n      errors\n    } = this.state;\n\n    switch (fieldName) {\n      case \"username\":\n        if (Validator.isEmpty(value)) {\n          errors.username = \"Username field is required\";\n          break;\n        }\n\n        errors.username = \"\";\n        break;\n\n      case \"password\":\n        if (Validator.isEmpty(value)) {\n          errors.password = \"Password field is required\";\n          break;\n        }\n\n        errors.password = \"\";\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  render() {\n    const {\n      errors,\n      loading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 7\n      }\n    }, loading ? showLoading() : null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container login-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"section\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 19\n      }\n    }, \"Login Form\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      className: \"col s12\",\n      noValidate: true,\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field col s12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      id: \"username\",\n      type: \"text\",\n      onChange: this.handleChange,\n      value: this.state.username,\n      className: classnames(\"\", {\n        invalid: errors.username\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      className: \"active\",\n      htmlFor: \"username\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 25\n      }\n    }, \"Username\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"red-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 25\n      }\n    }, errors.username))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field col s12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      id: \"password\",\n      onChange: this.handleChange,\n      value: this.state.password,\n      type: \"password\",\n      className: classnames(\"\", {\n        invalid: errors.password\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      className: \"active\",\n      htmlFor: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 25\n      }\n    }, \"Password\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"red-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 25\n      }\n    }, errors.password))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn waves-effect waves-light \",\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 23\n      }\n    }, \"Submit\"), /*#__PURE__*/React.createElement(Link, {\n      to: \"/\",\n      className: \"orange btn waves-effect waves-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 23\n      }\n    }, \"Cancel\")))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"divider\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col s6 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(GoogleLogin, {\n      className: \"waves-effect waves-light btn btn-large button-size\",\n      clientId: \"1001864418858-9a5bkmgdeqmee2bk7di7oudhjkq2370s.apps.googleusercontent.com\",\n      buttonText: \"Google Login\",\n      onSuccess: this.responseSuccessGoogle,\n      onFailure: this.responseErrorGoogle,\n      cookiePolicy: \"single_host_origin\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col s6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/register\",\n      className: \"waves-effect waves-light btn btn-large blue darken button-size\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 21\n      }\n    }, \"Create account\"))))))));\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["/Users/iashir/Desktop/WorkProjects/Recipe/client/src/components/login.jsx"],"names":["React","Component","Link","classnames","setAuthentication","isAuthenticated","showLoading","login","googleLogin","Validator","GoogleLogin","toast","Login","state","username","password","errors","loading","successMessage","componentDidMount","role","props","history","push","location","setState","responseSuccessGoogle","response","tokenId","then","res","token","user","data","console","log","window","reload","JSON","parse","localStorage","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","catch","err","responseErrorGoogle","validate","s","test","replace","trim","handleChange","e","badInput","target","value","id","validateForm","handleSubmit","preventDefault","userData","error","fieldName","isEmpty","render","invalid"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport classnames from \"classnames\";\nimport { setAuthentication, isAuthenticated } from \"./helper/auth\";\nimport { showLoading } from \"./helper/loading\";\nimport { login, googleLogin } from \"../api/auth\";\nimport Validator from \"validator\";\nimport GoogleLogin from \"react-google-login\";\nimport { toast } from \"react-toastify\";\n\nclass Login extends Component {\n  state = {\n    username: \"\",\n    password: \"\",\n    errors: {},\n    loading: false,\n    successMessage: \"\",\n  };\n\n  componentDidMount = () => {\n    if (isAuthenticated() && isAuthenticated().role === 1) {\n      this.props.history.push(\"/admin\");\n    } else if (isAuthenticated() && isAuthenticated().role === 0) {\n      this.props.history.push(\"/recipes\");\n    }\n    if (this.props.history.location.state) {\n      const { username, password } = this.props.history.location.state;\n      this.setState({ username, password });\n    }\n  };\n\n  responseSuccessGoogle = (response) => {\n    const tokenId = { tokenId: response.tokenId };\n    this.setState({ loading: true });\n    googleLogin(tokenId)\n      .then((res) => {\n        const { token, user } = res.data;\n        console.log(res.data);\n        setAuthentication(token, user);\n        if (isAuthenticated() && isAuthenticated().role === 1) {\n          this.props.history.push(\"/admin\");\n          window.location.reload(false);\n        } else {\n          this.props.history.push(\"/recipes\");\n          window.location.reload(false);\n        }\n        const { username } = JSON.parse(localStorage.user);\n        toast.success(`Signed in as ${username}`, {\n          position: \"bottom-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined,\n        });\n        this.setState({\n          loading: false,\n        });\n      })\n      .catch((err) => {\n        this.setState({ loading: false });\n      });\n  };\n\n  responseErrorGoogle = (response) => {\n    console.log(response);\n  };\n\n  validate = (s) => {\n    if (/^(\\w+\\s?)*\\s*$/.test(s)) {\n      return s.replace(/\\s+$/, \"\");\n    }\n    console.log(\"TEST\");\n    let trim = s.trim();\n    return trim;\n  };\n\n  handleChange = (e) => {\n    const badInput = e.target.value;\n    var value = badInput.replace(/  +/g, \" \");\n    this.setState({ [e.target.id]: value });\n    this.validateForm(e.target.id, value);\n  };\n  handleSubmit = (e) => {\n    e.preventDefault();\n    const userData = {\n      username: this.state.username.trim(),\n      password: this.state.password.trim(),\n    };\n    this.setState({ loading: true });\n    login(userData)\n      .then((res) => {\n        // Set User to localStorage and Token to Cookies\n        const { token, user } = res.data;\n        setAuthentication(token, user);\n        if (isAuthenticated() && isAuthenticated().role === 1) {\n          this.props.history.push(\"/admin/recipes\");\n          window.location.reload(false);\n        } else {\n          this.props.history.push(\"/recipes\");\n          window.location.reload(false);\n        }\n        this.setState({\n          loading: false,\n          successMessage: res.data.successMessage,\n        });\n        const { username } = JSON.parse(localStorage.user);\n        toast.success(`Signed in as ${username}`, {\n          position: \"bottom-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined,\n        });\n      })\n      .catch((err) => {\n        this.setState({ errors: err.response.data, loading: false });\n        toast.error(\"Username or Password is invalid\", {\n          position: \"bottom-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined,\n        });\n      });\n  };\n\n  validateForm(fieldName, value) {\n    const { errors } = this.state;\n    switch (fieldName) {\n      case \"username\":\n        if (Validator.isEmpty(value)) {\n          errors.username = \"Username field is required\";\n          break;\n        }\n        errors.username = \"\";\n        break;\n      case \"password\":\n        if (Validator.isEmpty(value)) {\n          errors.password = \"Password field is required\";\n          break;\n        }\n        errors.password = \"\";\n        break;\n      default:\n        break;\n    }\n  }\n\n  render() {\n    const { errors, loading } = this.state;\n\n    return (\n      <React.Fragment>\n        {loading ? showLoading() : null}\n        <div className=\"container login-container\">\n          <div className=\"card\">\n            <div className=\"card-content\">\n              <div className=\"section\">\n                <div className=\"row\">\n                  <h3>Login Form</h3>\n                </div>\n\n                <div className=\"row\">\n                  <form\n                    className=\"col s12\"\n                    noValidate\n                    onSubmit={this.handleSubmit}\n                  >\n                    <div className=\"row\">\n                      <div className=\"input-field col s12\">\n                        <input\n                          id=\"username\"\n                          type=\"text\"\n                          onChange={this.handleChange}\n                          value={this.state.username}\n                          className={classnames(\"\", {\n                            invalid: errors.username,\n                          })}\n                        />\n                        <label className=\"active\" htmlFor=\"username\">\n                          Username\n                        </label>\n                        <span className=\"red-text\">{errors.username}</span>\n                      </div>\n                    </div>\n\n                    <div className=\"row\">\n                      <div className=\"input-field col s12\">\n                        <input\n                          id=\"password\"\n                          onChange={this.handleChange}\n                          value={this.state.password}\n                          type=\"password\"\n                          className={classnames(\"\", {\n                            invalid: errors.password,\n                          })}\n                        />\n                        <label className=\"active\" htmlFor=\"password\">\n                          Password\n                        </label>\n                        <span className=\"red-text\">{errors.password}</span>\n                      </div>\n                    </div>\n\n                    <div className=\"row\">\n                      <button\n                        className=\"btn waves-effect waves-light \"\n                        type=\"submit\"\n                      >\n                        Submit\n                      </button>\n\n                      <Link\n                        to=\"/\"\n                        className=\"orange btn waves-effect waves-light\"\n                      >\n                        Cancel\n                      </Link>\n                    </div>\n                  </form>\n                </div>\n                <div className=\"divider\"></div>\n                <div className=\"row\">\n                  <div className=\"col s6 \">\n                    <GoogleLogin\n                      className=\"waves-effect waves-light btn btn-large button-size\"\n                      clientId=\"1001864418858-9a5bkmgdeqmee2bk7di7oudhjkq2370s.apps.googleusercontent.com\"\n                      buttonText=\"Google Login\"\n                      onSuccess={this.responseSuccessGoogle}\n                      onFailure={this.responseErrorGoogle}\n                      cookiePolicy={\"single_host_origin\"}\n                    />\n                  </div>\n                  <div className=\"col s6\">\n                    <Link\n                      to=\"/register\"\n                      className=\"waves-effect waves-light btn btn-large blue darken button-size\"\n                    >\n                      Create account\n                    </Link>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}