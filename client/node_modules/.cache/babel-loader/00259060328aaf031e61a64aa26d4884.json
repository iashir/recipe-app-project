{"ast":null,"code":"import _regeneratorRuntime from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/iashir/Desktop/WorkProjects/Recipe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{Link}from\"react-router-dom\";import axios from\"axios\";import classnames from\"classnames\";import Validator from\"validator\";import M from\"materialize-css\";import\"materialize-css/dist/css/materialize.min.css\";import{toast}from\"react-toastify\";import{showLoading}from\"./helper/loading\";var EditRecipe=/*#__PURE__*/function(_Component){_inherits(EditRecipe,_Component);var _super=_createSuper(EditRecipe);function EditRecipe(){var _this;_classCallCheck(this,EditRecipe);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={_id:\"\",title:\"\",body:\"\",status:\"\",category:\"\",ingredients:\"\",recipeImageName:\"\",recipeImageLocation:\"\",recipeImage:null,oldRecipeImage:true,categories:[],user:{},errors:{},loading:false};_this.componentDidMount=function(){var _JSON$parse=JSON.parse(localStorage.user),_id=_JSON$parse._id;_this.setState({user:_id,loading:true});var params=_this.props.match.params.id;axios.get(\"/api/categories\").then(function(_ref){var categories=_ref.data;_this.setState({categories:categories});});axios.get(\"/api/recipes/\"+params).then(function(_ref2){var data=_ref2.data;var title=data.title,body=data.body,status=data.status,recipeImageName=data.recipeImageName,recipeImageLocation=data.recipeImageLocation,_id=data._id,category=data.category,ingredients=data.ingredients;_this.setState({title:title,ingredients:ingredients,body:body,category:category,recipeImageName:recipeImageName,recipeImageLocation:recipeImageLocation,_id:_id,status:status,loading:false});M.AutoInit();});};_this.handleChange=function(event){if(event.target.id===\"recipeImage\"){_this.setState({recipeImage:event.target.files[0],oldRecipeImage:false});}else{_this.setState(_defineProperty({},event.target.id,event.target.value));_this.validateForm(event.target.id,event.target.value);}};_this.handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _this$state,title,body,status,user,recipeImage,_id,oldRecipeImage,category,ingredients,formData,obj;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_this.setState({loading:true});_this$state=_this.state,title=_this$state.title,body=_this$state.body,status=_this$state.status,user=_this$state.user,recipeImage=_this$state.recipeImage,_id=_this$state._id,oldRecipeImage=_this$state.oldRecipeImage,category=_this$state.category,ingredients=_this$state.ingredients;if(oldRecipeImage){_context.next=18;break;}console.log(\"WITH IMAGE\");formData=new FormData();formData.append(\"recipeImage\",recipeImage,recipeImage.name);formData.append(\"title\",title);formData.append(\"status\",status);formData.append(\"category\",category);formData.append(\"user\",user);formData.append(\"body\",body);formData.append(\"ingredients\",ingredients);console.log(formData);_context.next=16;return axios.put(\"/api/recipes/\"+_id,formData,{headers:{accept:\"application/json\",\"Accept-Language\":\"en-US,en;q=0.8\",\"Content-Type\":\"multipart/form-data; boundary=\".concat(formData._boundary)}}).then(function(data){toast.success(\"success\",{position:\"bottom-center\",autoClose:5000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});_this.props.history.push(\"/recipes\");}).catch(function(error){if(\"LIMIT_FILE_SIZE\"===error.code){_this.setState({errors:\"Max size 5MB\"});}else{_this.setState({errors:error.response.data});}});case 16:_context.next=21;break;case 18:obj={title:title,body:body,status:status,user:user,_id:_id,category:category,ingredients:ingredients};_context.next=21;return axios.put(\"/api/recipes/\"+_id,obj).then(function(data){toast.success(\"success\",{position:\"bottom-center\",autoClose:5000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});_this.props.history.push(\"/recipes/\"+_id);}).catch(function(err){return _this.setState({errors:err.response.data});});case 21:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref3.apply(this,arguments);};}();return _this;}_createClass(EditRecipe,[{key:\"validateForm\",value:function validateForm(fieldName,value){var errors=this.state.errors;switch(fieldName){case\"title\":if(Validator.isEmpty(value)){errors.title=\"Title field is required\";break;}errors.title=\"\";break;case\"body\":if(Validator.isEmpty(value)){errors.body=\"Description field is required\";break;}errors.body=\"\";break;case\"ingredients\":if(Validator.isEmpty(value)){errors.ingredients=\"Ingredients field is required\";break;}errors.ingredients=\"\";break;default:break;}}},{key:\"render\",value:function render(){var _this$state2=this.state,title=_this$state2.title,body=_this$state2.body,errors=_this$state2.errors,status=_this$state2.status,loading=_this$state2.loading,recipeImageName=_this$state2.recipeImageName,categories=_this$state2.categories,category=_this$state2.category,ingredients=_this$state2.ingredients;return/*#__PURE__*/React.createElement(React.Fragment,null,loading?showLoading():null,/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit,noValidate:true,encType:\"multipart/form-data\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"file-field input-field\"},/*#__PURE__*/React.createElement(\"div\",{className:\"btn\"},/*#__PURE__*/React.createElement(\"span\",null,\"Select\"),/*#__PURE__*/React.createElement(\"input\",{name:\"recipeImage\",onChange:this.handleChange,type:\"file\",id:\"recipeImage\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"file-path-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Recipe image(must be less than 5MB)\",defaultValue:recipeImageName,className:classnames(\"file-path \",{invalid:errors.recipeImage})}),/*#__PURE__*/React.createElement(\"span\",{className:\"red-text\"},errors.recipeImage)))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-field\"},/*#__PURE__*/React.createElement(\"input\",{value:title,onChange:this.handleChange,type:\"text\",id:\"title\",className:classnames(\"\",{invalid:errors.title})}),/*#__PURE__*/React.createElement(\"label\",{className:\"active\",htmlFor:\"title\"},\"Title\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-field\"},/*#__PURE__*/React.createElement(\"select\",{id:\"category\",onChange:this.handleChange,value:category},categories.map(function(data){return/*#__PURE__*/React.createElement(\"option\",{value:data._id},data.type);})),/*#__PURE__*/React.createElement(\"label\",null,\"Choose category\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-field\"},/*#__PURE__*/React.createElement(\"select\",{id:\"status\",onChange:this.handleChange,value:status},/*#__PURE__*/React.createElement(\"option\",{value:\"public\"},\"Public\"),/*#__PURE__*/React.createElement(\"option\",{value:\"private\"},\"Private\")),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"status\"},\"Choose status of your recipe\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-field\"},/*#__PURE__*/React.createElement(\"textarea\",{value:ingredients,onChange:this.handleChange,id:\"ingredients\",className:classnames(\"materialize-textarea\",{invalid:errors.ingredients})}),/*#__PURE__*/React.createElement(\"label\",{className:\"active\",htmlFor:\"ingredients\"},\"Ingredients\"),/*#__PURE__*/React.createElement(\"span\",{className:\"red-text\"},errors.ingredients))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-field\"},/*#__PURE__*/React.createElement(\"textarea\",{value:body,onChange:this.handleChange,id:\"body\",className:classnames(\"materialize-textarea\",{invalid:errors.body})}),/*#__PURE__*/React.createElement(\"label\",{className:\"active\",htmlFor:\"body\"},\"Description\"),/*#__PURE__*/React.createElement(\"span\",{className:\"red-text\"},errors.body))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Save\",className:\"btn\"}),/*#__PURE__*/React.createElement(Link,{to:\"/recipes\",className:\"btn orange\"},\"Cancel\"))))))));}}]);return EditRecipe;}(Component);export default EditRecipe;","map":{"version":3,"sources":["/Users/iashir/Desktop/WorkProjects/Recipe/client/src/components/editRecipe.jsx"],"names":["React","Component","Link","axios","classnames","Validator","M","toast","showLoading","EditRecipe","state","_id","title","body","status","category","ingredients","recipeImageName","recipeImageLocation","recipeImage","oldRecipeImage","categories","user","errors","loading","componentDidMount","JSON","parse","localStorage","setState","params","props","match","id","get","then","data","AutoInit","handleChange","event","target","files","value","validateForm","handleSubmit","preventDefault","console","log","formData","FormData","append","name","put","headers","accept","_boundary","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","history","push","catch","error","code","response","obj","err","fieldName","isEmpty","invalid","map","type"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport classnames from \"classnames\";\nimport Validator from \"validator\";\nimport M from \"materialize-css\";\nimport \"materialize-css/dist/css/materialize.min.css\";\nimport { toast } from \"react-toastify\";\nimport { showLoading } from \"./helper/loading\";\nclass EditRecipe extends Component {\n  state = {\n    _id: \"\",\n    title: \"\",\n    body: \"\",\n    status: \"\",\n    category: \"\",\n    ingredients: \"\",\n    recipeImageName: \"\",\n    recipeImageLocation: \"\",\n    recipeImage: null,\n    oldRecipeImage: true,\n    categories: [],\n    user: {},\n    errors: {},\n    loading: false,\n  };\n  componentDidMount = () => {\n    const { _id } = JSON.parse(localStorage.user);\n\n    this.setState({ user: _id, loading: true });\n    const params = this.props.match.params.id;\n    axios.get(\"/api/categories\").then(({ data: categories }) => {\n      this.setState({\n        categories,\n      });\n    });\n    axios.get(\"/api/recipes/\" + params).then(({ data }) => {\n      const {\n        title,\n        body,\n        status,\n        recipeImageName,\n        recipeImageLocation,\n        _id,\n        category,\n        ingredients,\n      } = data;\n      this.setState({\n        title,\n        ingredients,\n        body,\n        category,\n        recipeImageName,\n        recipeImageLocation,\n        _id,\n        status,\n        loading: false,\n      });\n      M.AutoInit();\n    });\n  };\n\n  handleChange = (event) => {\n    if (event.target.id === \"recipeImage\") {\n      this.setState({\n        recipeImage: event.target.files[0],\n        oldRecipeImage: false,\n      });\n    } else {\n      this.setState({ [event.target.id]: event.target.value });\n      this.validateForm(event.target.id, event.target.value);\n    }\n  };\n  handleSubmit = async (event) => {\n    event.preventDefault();\n    this.setState({ loading: true });\n    const {\n      title,\n      body,\n      status,\n      user,\n      recipeImage,\n      _id,\n      oldRecipeImage,\n      category,\n      ingredients,\n    } = this.state;\n    if (!oldRecipeImage) {\n      console.log(\"WITH IMAGE\");\n      let formData = new FormData();\n      formData.append(\"recipeImage\", recipeImage, recipeImage.name);\n      formData.append(\"title\", title);\n      formData.append(\"status\", status);\n      formData.append(\"category\", category);\n      formData.append(\"user\", user);\n      formData.append(\"body\", body);\n      formData.append(\"ingredients\", ingredients);\n      console.log(formData);\n\n      await axios\n        .put(\"/api/recipes/\" + _id, formData, {\n          headers: {\n            accept: \"application/json\",\n            \"Accept-Language\": \"en-US,en;q=0.8\",\n            \"Content-Type\": `multipart/form-data; boundary=${formData._boundary}`,\n          },\n        })\n        .then((data) => {\n          toast.success(`success`, {\n            position: \"bottom-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n          });\n          this.props.history.push(\"/recipes\");\n        })\n        .catch((error) => {\n          if (\"LIMIT_FILE_SIZE\" === error.code) {\n            this.setState({ errors: \"Max size 5MB\" });\n          } else {\n            this.setState({ errors: error.response.data });\n          }\n        });\n    } else {\n      const obj = {\n        title,\n        body,\n        status,\n        user,\n        _id,\n        category,\n        ingredients,\n      };\n      await axios\n        .put(\"/api/recipes/\" + _id, obj)\n        .then((data) => {\n          toast.success(`success`, {\n            position: \"bottom-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n          });\n          this.props.history.push(\"/recipes/\" + _id);\n        })\n        .catch((err) => this.setState({ errors: err.response.data }));\n    }\n  };\n  validateForm(fieldName, value) {\n    const { errors } = this.state;\n    switch (fieldName) {\n      case \"title\":\n        if (Validator.isEmpty(value)) {\n          errors.title = \"Title field is required\";\n          break;\n        }\n        errors.title = \"\";\n        break;\n      case \"body\":\n        if (Validator.isEmpty(value)) {\n          errors.body = \"Description field is required\";\n          break;\n        }\n        errors.body = \"\";\n        break;\n      case \"ingredients\":\n        if (Validator.isEmpty(value)) {\n          errors.ingredients = \"Ingredients field is required\";\n          break;\n        }\n        errors.ingredients = \"\";\n        break;\n      default:\n        break;\n    }\n  }\n  render() {\n    const {\n      title,\n      body,\n      errors,\n      status,\n      loading,\n      recipeImageName,\n      categories,\n      category,\n      ingredients,\n    } = this.state;\n    return (\n      <React.Fragment>\n        {loading ? showLoading() : null}\n        <div className=\"container\">\n          <div className=\"card\">\n            <div className=\"card-content\">\n              <div className=\"row\">\n                <form\n                  onSubmit={this.handleSubmit}\n                  noValidate\n                  encType=\"multipart/form-data\"\n                >\n                  <div className=\"row\">\n                    <div className=\"file-field input-field\">\n                      <div className=\"btn\">\n                        <span>Select</span>\n                        <input\n                          name=\"recipeImage\"\n                          onChange={this.handleChange}\n                          type=\"file\"\n                          id=\"recipeImage\"\n                        />\n                      </div>\n                      <div className=\"file-path-wrapper\">\n                        <input\n                          type=\"text\"\n                          placeholder=\"Recipe image(must be less than 5MB)\"\n                          defaultValue={recipeImageName}\n                          className={classnames(\"file-path \", {\n                            invalid: errors.recipeImage,\n                          })}\n                        />\n                        <span className=\"red-text\">{errors.recipeImage}</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <input\n                        value={title}\n                        onChange={this.handleChange}\n                        type=\"text\"\n                        id=\"title\"\n                        className={classnames(\"\", {\n                          invalid: errors.title,\n                        })}\n                      />\n                      <label className=\"active\" htmlFor=\"title\">\n                        Title\n                      </label>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <select\n                        id=\"category\"\n                        onChange={this.handleChange}\n                        value={category}\n                      >\n                        {categories.map((data) => (\n                          <option value={data._id}>{data.type}</option>\n                        ))}\n                      </select>\n                      <label>Choose category</label>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <select\n                        id=\"status\"\n                        onChange={this.handleChange}\n                        value={status}\n                      >\n                        <option value=\"public\">Public</option>\n                        <option value=\"private\">Private</option>\n                      </select>\n                      <label htmlFor=\"status\">\n                        Choose status of your recipe\n                      </label>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <textarea\n                        value={ingredients}\n                        onChange={this.handleChange}\n                        id=\"ingredients\"\n                        className={classnames(\"materialize-textarea\", {\n                          invalid: errors.ingredients,\n                        })}\n                      ></textarea>\n                      <label className=\"active\" htmlFor=\"ingredients\">\n                        Ingredients\n                      </label>\n                      <span className=\"red-text\">{errors.ingredients}</span>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <textarea\n                        value={body}\n                        onChange={this.handleChange}\n                        id=\"body\"\n                        className={classnames(\"materialize-textarea\", {\n                          invalid: errors.body,\n                        })}\n                      ></textarea>\n                      <label className=\"active\" htmlFor=\"body\">\n                        Description\n                      </label>\n                      <span className=\"red-text\">{errors.body}</span>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <input type=\"submit\" value=\"Save\" className=\"btn\" />\n                    <Link to=\"/recipes\" className=\"btn orange\">\n                      Cancel\n                    </Link>\n                  </div>\n                </form>\n              </div>\n            </div>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default EditRecipe;\n"]},"metadata":{},"sourceType":"module"}