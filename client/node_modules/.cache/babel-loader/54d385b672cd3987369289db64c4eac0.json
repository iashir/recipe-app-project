{"ast":null,"code":"var _jsxFileName = \"/Users/iashir/Desktop/WorkProjects/Recipe/client/src/components/editRecipe.jsx\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport classnames from \"classnames\";\nimport Validator from \"validator\";\nimport M from \"materialize-css\";\nimport \"materialize-css/dist/css/materialize.min.css\";\nimport { toast } from \"react-toastify\";\nimport { showLoading } from \"./helper/loading\";\n\nclass EditRecipe extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      _id: \"\",\n      title: \"\",\n      body: \"\",\n      status: \"\",\n      category: \"\",\n      ingredients: \"\",\n      recipeImageName: \"\",\n      recipeImageLocation: \"\",\n      recipeImage: null,\n      oldRecipeImage: true,\n      categories: [],\n      user: {},\n      errors: {},\n      loading: false\n    };\n\n    this.componentDidMount = () => {\n      const {\n        _id\n      } = JSON.parse(localStorage.user);\n      this.setState({\n        user: _id,\n        loading: true\n      });\n      const params = this.props.match.params.id;\n      axios.get(\"/api/categories\").then(({\n        data: categories\n      }) => {\n        this.setState({\n          categories\n        });\n      });\n      axios.get(\"/api/recipes/\" + params).then(({\n        data\n      }) => {\n        const {\n          title,\n          body,\n          status,\n          recipeImageName,\n          recipeImageLocation,\n          _id,\n          category,\n          ingredients\n        } = data;\n        this.setState({\n          title,\n          ingredients,\n          body,\n          category,\n          recipeImageName,\n          recipeImageLocation,\n          _id,\n          status,\n          loading: false\n        });\n        M.AutoInit();\n      });\n    };\n\n    this.handleChange = event => {\n      if (event.target.id === \"recipeImage\") {\n        this.setState({\n          recipeImage: event.target.files[0],\n          oldRecipeImage: false\n        });\n      } else {\n        this.setState({\n          [event.target.id]: event.target.value\n        });\n        this.validateForm(event.target.id, event.target.value);\n      }\n    };\n\n    this.handleSubmit = async event => {\n      event.preventDefault();\n      this.setState({\n        loading: true\n      });\n      const {\n        title,\n        body,\n        status,\n        user,\n        recipeImage,\n        _id,\n        oldRecipeImage,\n        category,\n        ingredients\n      } = this.state;\n\n      if (!oldRecipeImage) {\n        console.log(\"WITH IMAGE\");\n        let formData = new FormData();\n        formData.append(\"recipeImage\", recipeImage, recipeImage.name);\n        formData.append(\"title\", title);\n        formData.append(\"status\", status);\n        formData.append(\"category\", category);\n        formData.append(\"user\", user);\n        formData.append(\"body\", body);\n        formData.append(\"body\", ing);\n        console.log(formData);\n        await axios.put(\"/api/recipes/\" + _id, formData, {\n          headers: {\n            accept: \"application/json\",\n            \"Accept-Language\": \"en-US,en;q=0.8\",\n            \"Content-Type\": `multipart/form-data; boundary=${formData._boundary}`\n          }\n        }).then(data => {\n          toast.success(`success`, {\n            position: \"bottom-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined\n          });\n          this.props.history.push(\"/recipes\");\n        }).catch(error => {\n          if (\"LIMIT_FILE_SIZE\" === error.code) {\n            this.setState({\n              errors: \"Max size 5MB\"\n            });\n          } else {\n            this.setState({\n              errors: error.response.data\n            });\n          }\n        });\n      } else {\n        const obj = {\n          title,\n          body,\n          status,\n          user,\n          _id,\n          category\n        };\n        await axios.put(\"/api/recipes/\" + _id, obj).then(data => {\n          toast.success(`success`, {\n            position: \"bottom-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined\n          });\n          this.props.history.push(\"/recipes/\" + _id);\n        }).catch(err => this.setState({\n          errors: err.response.data\n        }));\n      }\n    };\n  }\n\n  validateForm(fieldName, value) {\n    const {\n      errors\n    } = this.state;\n\n    switch (fieldName) {\n      case \"title\":\n        if (Validator.isEmpty(value)) {\n          errors.title = \"Title field is required\";\n          break;\n        }\n\n        errors.title = \"\";\n        break;\n\n      case \"body\":\n        if (Validator.isEmpty(value)) {\n          errors.body = \"Description field is required\";\n          break;\n        }\n\n        errors.body = \"\";\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  render() {\n    const {\n      title,\n      body,\n      errors,\n      status,\n      loading,\n      recipeImageName,\n      categories,\n      category\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 7\n      }\n    }, loading ? showLoading() : null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      noValidate: true,\n      encType: \"multipart/form-data\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"file-field input-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 25\n      }\n    }, \"Select\"), /*#__PURE__*/React.createElement(\"input\", {\n      name: \"recipeImage\",\n      onChange: this.handleChange,\n      type: \"file\",\n      id: \"recipeImage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"file-path-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Recipe image(must be less than 5MB)\",\n      defaultValue: recipeImageName,\n      className: classnames(\"file-path \", {\n        invalid: errors.recipeImage\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"red-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 25\n      }\n    }, errors.recipeImage)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      value: title,\n      onChange: this.handleChange,\n      type: \"text\",\n      id: \"title\",\n      className: classnames(\"\", {\n        invalid: errors.title\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      className: \"active\",\n      htmlFor: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 23\n      }\n    }, \"Title\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      id: \"category\",\n      onChange: this.handleChange,\n      value: category,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 23\n      }\n    }, categories.map(data => /*#__PURE__*/React.createElement(\"option\", {\n      value: data._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 27\n      }\n    }, data.type))), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 23\n      }\n    }, \"Choose category\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      id: \"status\",\n      onChange: this.handleChange,\n      value: status,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"public\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 25\n      }\n    }, \"Public\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"private\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 25\n      }\n    }, \"Private\")), /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"status\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 23\n      }\n    }, \"Choose status of your recipe\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"textarea\", {\n      value: body,\n      onChange: this.handleChange,\n      id: \"body\",\n      className: classnames(\"materialize-textarea\", {\n        invalid: errors.body\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      className: \"active\",\n      htmlFor: \"body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 23\n      }\n    }, \"Description\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"red-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 23\n      }\n    }, errors.body))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"submit\",\n      value: \"Save\",\n      className: \"btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Link, {\n      to: \"/recipes\",\n      className: \"btn orange\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 21\n      }\n    }, \"Cancel\"))))))));\n  }\n\n}\n\nexport default EditRecipe;","map":{"version":3,"sources":["/Users/iashir/Desktop/WorkProjects/Recipe/client/src/components/editRecipe.jsx"],"names":["React","Component","Link","axios","classnames","Validator","M","toast","showLoading","EditRecipe","state","_id","title","body","status","category","ingredients","recipeImageName","recipeImageLocation","recipeImage","oldRecipeImage","categories","user","errors","loading","componentDidMount","JSON","parse","localStorage","setState","params","props","match","id","get","then","data","AutoInit","handleChange","event","target","files","value","validateForm","handleSubmit","preventDefault","console","log","formData","FormData","append","name","ing","put","headers","accept","_boundary","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","history","push","catch","error","code","response","obj","err","fieldName","isEmpty","render","invalid","map","type"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport classnames from \"classnames\";\nimport Validator from \"validator\";\nimport M from \"materialize-css\";\nimport \"materialize-css/dist/css/materialize.min.css\";\nimport { toast } from \"react-toastify\";\nimport { showLoading } from \"./helper/loading\";\nclass EditRecipe extends Component {\n  state = {\n    _id: \"\",\n    title: \"\",\n    body: \"\",\n    status: \"\",\n    category: \"\",\n    ingredients: \"\",\n    recipeImageName: \"\",\n    recipeImageLocation: \"\",\n    recipeImage: null,\n    oldRecipeImage: true,\n    categories: [],\n    user: {},\n    errors: {},\n    loading: false,\n  };\n  componentDidMount = () => {\n    const { _id } = JSON.parse(localStorage.user);\n\n    this.setState({ user: _id, loading: true });\n    const params = this.props.match.params.id;\n    axios.get(\"/api/categories\").then(({ data: categories }) => {\n      this.setState({\n        categories,\n      });\n    });\n    axios.get(\"/api/recipes/\" + params).then(({ data }) => {\n      const {\n        title,\n        body,\n        status,\n        recipeImageName,\n        recipeImageLocation,\n        _id,\n        category,\n        ingredients,\n      } = data;\n      this.setState({\n        title,\n        ingredients,\n        body,\n        category,\n        recipeImageName,\n        recipeImageLocation,\n        _id,\n        status,\n        loading: false,\n      });\n      M.AutoInit();\n    });\n  };\n\n  handleChange = (event) => {\n    if (event.target.id === \"recipeImage\") {\n      this.setState({\n        recipeImage: event.target.files[0],\n        oldRecipeImage: false,\n      });\n    } else {\n      this.setState({ [event.target.id]: event.target.value });\n      this.validateForm(event.target.id, event.target.value);\n    }\n  };\n  handleSubmit = async (event) => {\n    event.preventDefault();\n    this.setState({ loading: true });\n    const {\n      title,\n      body,\n      status,\n      user,\n      recipeImage,\n      _id,\n      oldRecipeImage,\n      category,\n      ingredients\n    } = this.state;\n    if (!oldRecipeImage) {\n      console.log(\"WITH IMAGE\");\n      let formData = new FormData();\n      formData.append(\"recipeImage\", recipeImage, recipeImage.name);\n      formData.append(\"title\", title);\n      formData.append(\"status\", status);\n      formData.append(\"category\", category);\n      formData.append(\"user\", user);\n      formData.append(\"body\", body);\n      formData.append(\"body\", ing);\n      console.log(formData);\n\n      await axios\n        .put(\"/api/recipes/\" + _id, formData, {\n          headers: {\n            accept: \"application/json\",\n            \"Accept-Language\": \"en-US,en;q=0.8\",\n            \"Content-Type\": `multipart/form-data; boundary=${formData._boundary}`,\n          },\n        })\n        .then((data) => {\n          toast.success(`success`, {\n            position: \"bottom-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n          });\n          this.props.history.push(\"/recipes\");\n        })\n        .catch((error) => {\n          if (\"LIMIT_FILE_SIZE\" === error.code) {\n            this.setState({ errors: \"Max size 5MB\" });\n          } else {\n            this.setState({ errors: error.response.data });\n          }\n        });\n    } else {\n      const obj = {\n        title,\n        body,\n        status,\n        user,\n        _id,\n        category,\n      };\n      await axios\n        .put(\"/api/recipes/\" + _id, obj)\n        .then((data) => {\n          toast.success(`success`, {\n            position: \"bottom-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n          });\n          this.props.history.push(\"/recipes/\" + _id);\n        })\n        .catch((err) => this.setState({ errors: err.response.data }));\n    }\n  };\n  validateForm(fieldName, value) {\n    const { errors } = this.state;\n    switch (fieldName) {\n      case \"title\":\n        if (Validator.isEmpty(value)) {\n          errors.title = \"Title field is required\";\n          break;\n        }\n        errors.title = \"\";\n        break;\n      case \"body\":\n        if (Validator.isEmpty(value)) {\n          errors.body = \"Description field is required\";\n          break;\n        }\n        errors.body = \"\";\n        break;\n      default:\n        break;\n    }\n  }\n  render() {\n    const {\n      title,\n      body,\n      errors,\n      status,\n      loading,\n      recipeImageName,\n      categories,\n      category,\n    } = this.state;\n    return (\n      <React.Fragment>\n        {loading ? showLoading() : null}\n        <div className=\"container\">\n          <div className=\"card\">\n            <div className=\"card-content\">\n              <div className=\"row\">\n                <form\n                  onSubmit={this.handleSubmit}\n                  noValidate\n                  encType=\"multipart/form-data\"\n                >\n                  <div className=\"row\">\n                    <div className=\"file-field input-field\">\n                      <div className=\"btn\">\n                        <span>Select</span>\n                        <input\n                          name=\"recipeImage\"\n                          onChange={this.handleChange}\n                          type=\"file\"\n                          id=\"recipeImage\"\n                        />\n                      </div>\n                      <div className=\"file-path-wrapper\">\n                        <input\n                          type=\"text\"\n                          placeholder=\"Recipe image(must be less than 5MB)\"\n                          defaultValue={recipeImageName}\n                          className={classnames(\"file-path \", {\n                            invalid: errors.recipeImage,\n                          })}\n                        />\n                        <span className=\"red-text\">{errors.recipeImage}</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <input\n                        value={title}\n                        onChange={this.handleChange}\n                        type=\"text\"\n                        id=\"title\"\n                        className={classnames(\"\", {\n                          invalid: errors.title,\n                        })}\n                      />\n                      <label className=\"active\" htmlFor=\"title\">\n                        Title\n                      </label>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <select\n                        id=\"category\"\n                        onChange={this.handleChange}\n                        value={category}\n                      >\n                        {categories.map((data) => (\n                          <option value={data._id}>{data.type}</option>\n                        ))}\n                      </select>\n                      <label>Choose category</label>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <select\n                        id=\"status\"\n                        onChange={this.handleChange}\n                        value={status}\n                      >\n                        <option value=\"public\">Public</option>\n                        <option value=\"private\">Private</option>\n                      </select>\n                      <label htmlFor=\"status\">\n                        Choose status of your recipe\n                      </label>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <div className=\"input-field\">\n                      <textarea\n                        value={body}\n                        onChange={this.handleChange}\n                        id=\"body\"\n                        className={classnames(\"materialize-textarea\", {\n                          invalid: errors.body,\n                        })}\n                      ></textarea>\n                      <label className=\"active\" htmlFor=\"body\">\n                        Description\n                      </label>\n                      <span className=\"red-text\">{errors.body}</span>\n                    </div>\n                  </div>\n\n                  <div className=\"row\">\n                    <input type=\"submit\" value=\"Save\" className=\"btn\" />\n                    <Link to=\"/recipes\" className=\"btn orange\">\n                      Cancel\n                    </Link>\n                  </div>\n                </form>\n              </div>\n            </div>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default EditRecipe;\n"]},"metadata":{},"sourceType":"module"}